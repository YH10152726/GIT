エラーチェック判定ロジック解説 (V3)
このドキュメントでは、VBAコード SummarizePastProcessErrors_V3 に実装されている各エラーチェック機能の判定ロジックを説明します。各エラーは、部品の工程データ（品名が変わるまでの行の集まり）を一つの単位としてチェックされます。
前提:
 * Y列: 部品全体の備考
 * Z列: 部品全体の購入先/処理情報（熱処理方法、コーティング種別など）
 * AC列: 材質 (部品全体の材質)
 * AE列: 焼入れ硬度
 * AH列: 品名 (これで部品の区切りを判断)
 * AJ列: 工程名
 * AL列: 仕入れ先略称 (業者名)
 * AT列: 工程備考
E01: 材質と購入先の不整合 (CheckE01_MaterialSupplierMismatch_V2)
 * 条件:
   * AJ列（工程名）に「主材購入」という工程が存在する場合。
 * 判定:
   * AC列（材質）の値に基づいて、期待されるAL列（仕入れ先略称）の業者が決まります（例: SKH51ならメタルワン、DC53なら深江特殊鋼など、コード内のSelect Case文で定義）。
   * もし、実際のAL列の業者が、この期待される業者と異なる場合（かつ、両方に有効な業者名が記録されている場合）、エラーとしてカウントされます。
 * ロジック: AC列の材質に対して、AJ列「主材購入」のAL列（業者）が標準と異なる。
E02: 材質と熱処理業者の不整合 (CheckE02_MaterialHeatTreatSupplierMismatch_V2)
 * 条件:
   * 部品の工程内にAJ列（工程名）が「熱処理」である工程が存在する場合。
 * 判定:
   * まず、Z列（部品全体の処理情報）から「サブゼロ処理」の有無を判定します（"SUB0", "ｻﾌﾞ0", "S0", "サブゼロ" のキーワードで判断）。
   * サブゼロ処理がある場合：期待されるAL列（業者名）は「ｴｼﾞｿﾝ熱処理」です。
   * サブゼロ処理がない場合：AC列（材質）に基づいて期待される業者が決まります（例: SKH51ならﾘﾋﾄ精光、DC53なら光陽産業 高温など）。
   * 「熱処理」工程のAL列（業者名）が、これらの期待される業者と異なる場合（かつ、両方に有効な業者名が記録されている場合）、エラーとしてカウントされます。
 * ロジック: AC列の材質とZ列のサブゼロ指示に対して、AJ列「熱処理」のAL列（業者）が標準と異なる。
E03: コーティング種類とコーティング業者の不整合 (CheckE03_CoatingTypeSupplierMismatch_V2)
 * 条件:
   * Z列（部品全体の処理情報）に特定のコーティング種別（"ALCRN", "TICN", "DNF"）が指示されている場合。
 * 判定:
   * Z列からコーティング種別を特定します。
   * 特定されたコーティング種別に対して、期待される業者が決まります（AlCrNなら和興産業、TiCNなら北熱など）。
   * 部品の工程内にAJ列（工程名）が「外注」であるか、または工程名自体にコーティング種別名（例: "ALCRN処理"）が含まれる工程を探します。
   * 該当する工程のAL列（業者名）が、期待される業者と異なる場合（かつ、両方に有効な業者名が記録されている場合）、エラーとしてカウントされます。
 * ロジック: Z列のコーティング指示に対して、関連する「外注」工程またはコーティング工程のAL列（業者）が標準と異なる。
E04A: コーティング指示あり、磨き工程なし (CheckE04_CoatingRelatedProcess_V2)
 * 条件:
   * Z列（部品全体の処理情報）に特定のコーティング種別（"ALCRN", "TICN", "DNF"）が指示されている場合。
 * 判定:
   * 上記条件に該当し、かつ部品の工程内にAJ列（工程名）が「磨き」である工程が存在しない場合、エラーとしてカウントされます。
 * ロジック: Z列でコーティング指示があるのに、「磨き」工程がない。
E04B: コーティング指示あり、対応外注工程なし (CheckE04_CoatingRelatedProcess_V2)
 * 条件:
   * Z列（部品全体の処理情報）に特定のコーティング種別（"ALCRN", "TICN", "DNF"）が指示されている場合。
 * 判定:
   * Z列からコーティング種別と期待されるコーティング業者を特定します。
   * 部品の工程内に、以下のいずれかの条件を満たす工程が存在しない場合、エラーとしてカウントされます。
     * AJ列（工程名）が「外注」で、かつAL列（業者名）が期待されるコーティング業者である。
     * AJ列（工程名）自体に、指示されたコーティング種別名（例: "ALCRN処理"）が含まれている。
 * ロジック: Z列でコーティング指示があるのに、適切なコーティング業者への「外注」工程も、直接的なコーティング工程名も見つからない。
E05A: 熱処理必須材質なのに熱処理工程なし (CheckE05_HeatTreatmentNecessity_V2)
 * 条件:
   * AC列（材質）が、一般的に熱処理が必須とされる材質（例: SKD11, SKH51など。NAK80, FDAC, SS400は除く）である場合。
 * 判定:
   * 上記条件に該当し、かつ部品の工程内にAJ列（工程名）が「熱処理」である工程が存在しない場合、エラーとしてカウントされます。
 * ロジック: 熱処理が必要なAC列の材質なのに、「熱処理」工程がない。
E05B: 熱処理不要材質なのに熱処理工程あり (CheckE05_HeatTreatmentNecessity_V2)
 * 条件:
   * AC列（材質）が、一般的に熱処理が不要とされる材質（"NAK80", "FDAC", "SS400"）である場合。
 * 判定:
   * 上記条件に該当し、かつ部品の工程内にAJ列（工程名）が「熱処理」である工程が存在する場合、エラーとしてカウントされます。
 * ロジック: 熱処理が不要なAC列の材質なのに、「熱処理」工程がある。
E08: 外注指示で業者名欠落 (CheckE08_OutsourceSupplierMissing_V2)
 * 条件:
   * 部品の工程内にAJ列（工程名）が「外注」である工程が存在する場合。
 * 判定:
   * 該当する「外注」工程のAL列（仕入れ先略称＝業者名）が空欄の場合、エラーとしてカウントされます。
 * ロジック: AJ列「外注」なのに、AL列（業者）が空。
E09A: 主材購入で業者名欠落 (CheckE09_PurchaseRelated_V2)
 * 条件:
   * 部品の工程内にAJ列（工程名）が「主材購入」である工程が存在する場合。
 * 判定:
   * 該当する「主材購入」工程のAL列（仕入れ先略称＝業者名）が空欄の場合、エラーとしてカウントされます。（部品内で最初に見つかった1件のみカウント）
 * ロジック: AJ列「主材購入」なのに、AL列（業者）が空。
E09B: ミスミ購入品と主材購入が重複 (CheckE09_PurchaseRelated_V2)
 * 条件:
   * 部品の工程内にAJ列（工程名）が「副材（購入品）」かつAL列（業者名）が「ﾐｽﾐ」である工程が存在する場合（＝ミスミ購入品である）。
 * 判定:
   * 上記条件に該当し、かつ同じ部品の工程内にAJ列（工程名）が「主材購入」である工程も存在する場合、エラーとしてカウントされます。
 * ロジック: 「副材（購入品）」で業者「ﾐｽﾐ」があるのに、別途「主材購入」工程もある。
E10A: ゲイビ外注(材料～焼き)なのに後工程なし (CheckE10_GeibiOutsourcePattern_V2)
 * 条件:
   * Y列（部品全体備考）またはZ列（部品全体処理情報）に「材料～焼きまで」または「材料~焼きまで」というキーワードが存在する。
   * かつ、部品の工程内にAJ列（工程名）が「外注」でAL列（業者名）が「ｹﾞｲﾋﾞ鋼業」である工程が存在する（または、その外注工程のAT列（工程備考）に上記キーワードがある）。
 * 判定:
   * 上記両方の条件に該当し、かつ部品の工程内に特定の「後工程」（例: "平面研削 NC", "ワイヤ放電加工", "調整P"など）が一つも存在しない場合、エラーとしてカウントされます。
 * ロジック: ゲイビ鋼業へ「材料～焼きまで」で外注したはずなのに、その後の自社での仕上げ工程等がない。
E10B: ゲイビ外注(荒加工のみ)で熱処理必須なのに熱処理なし (CheckE10_GeibiOutsourcePattern_V2)
 * 条件:
   * Y列（部品全体備考）またはZ列（部品全体処理情報）に「荒加工のみ」というキーワードが存在する。
   * かつ、部品の工程内にAJ列（工程名）が「外注」でAL列（業者名）が「ｹﾞｲﾋﾞ鋼業」である工程が存在する（または、その外注工程のAT列（工程備考）に上記キーワードがある）。
   * かつ、AC列（材質）が熱処理必須の材質である（NAK80, FDAC, SS400などを除く）。
 * 判定:
   * 上記全ての条件に該当し、かつ部品の工程内にAJ列（工程名）が「熱処理」である工程が存在しない場合、エラーとしてカウントされます。
 * ロジック: ゲイビ鋼業へ「荒加工のみ」で外注し、材質的に熱処理が必要なのに、自社での「熱処理」工程がない。
E11: M/C工程の連続回数と工程備考の不整合 (CheckE11_MCProcessRemarksMismatch_V2)
 * 条件:
   * AJ列（工程名）が「M/C」で始まる工程（例: "M/C（小）", "M/C-1"）が複数回連続している場合（間に他の種類の工程を挟まない）。
 * 判定:
   * 連続するM/C工程のAT列（工程備考）に、期待される連番（例: 3回連続なら "1/3", "2/3", "3/3"）が記載されていない場合、エラーとしてカウントされます。
   * 具体的には、備考が空欄で連続回数が2回以上の場合や、備考に何かしら記載があるが期待される連番形式でない場合にエラーとなります。
 * ロジック: 連続するM/C工程のAT列（工程備考）の連番表記が正しくない。
E12: 焼き入れ後SG回数の不整合 (限定的チェック) (CheckE12_SGProcessCountMismatch_V2)
 * 条件:
   * 部品の工程内のAJ列（工程名）「平面研削 NC」の回数をカウントします。
   * Y列（部品全体備考）から「材変レイアウト」や「ファミリー加工」のキーワードがあるか、またはAJ列に「ファミリー加工」という工程名があるかで、「ファミリー加工」部品かどうかを簡易的に判定します。
 * 判定:
   * 「ファミリー加工」部品と判定された場合： 「平面研削 NC」工程が存在し、かつその回数が2回でない場合、エラーとしてカウントされます。
   * 「ファミリー加工」部品と判定されなかった場合： 「平面研削 NC」工程の回数が6回を超える場合、エラーとしてカウントされます（極端に多い場合のチェック）。
 * ロジック: 部品の形状（ファミリー加工か否か）に対して、「平面研削 NC」の回数が標準的でない。
E13: 熱処理指示と焼入れ硬度記録の不整合 (CheckE13_HeatTreatHardnessMismatch_V3)
 * 条件:
   * 「熱処理指示の有無」を判定：部品の工程内にAJ列（工程名）「熱処理」があるか、またはZ列（部品全体処理情報）に熱処理関連のキーワード（"焼入", "熱処理", "調質", "SUB0", "サブゼロ", "S0"）があるか。
   * 「焼入れ硬度記録の有無」を判定：AE列（焼入れ硬度）に有効な硬度記録があるか（空欄でなく、"－"や"なし"といった除外文字列でなく、数値や"HRC", "HV"で始まるか）。
 * 判定:
   * 熱処理指示があるのに、焼入れ硬度記録がない場合、エラー。
   * 熱処理指示がないのに、焼入れ硬度記録がある場合、エラー。
 * ロジック: 熱処理の実施（または指示）と、AE列の硬度記録が論理的に一致しない。
E16: 不適切な工程順序 (例: 熱処理後の荒加工) (CheckE16_ImproperProcessOrder_V3)
 * 条件:
   * 部品の工程内にAJ列（工程名）が「熱処理」である工程が存在し、かつそれが最終工程ではない場合。
 * 判定:
   * 「熱処理」工程よりも後（下の行）の工程に、AJ列（工程名）が「M/C」で始まり、かつ工程名またはAT列（工程備考）に「荒」というキーワードが含まれるか、または工程名が「M/C-1」や「MC-1」であるような「荒加工」と見なされるM/C工程が存在する場合、エラーとしてカウントされます。
 * ロジック: 「熱処理」後に、通常は行わないはずの「荒加工」に分類されるM/C工程がある。
E17: Y列備考｢ファミリー加工｣指示と関連工程の不整合 (CheckE17_FamilyProcessMismatch_V3)
 * 条件:
   * Y列（部品全体備考）に「材変レイアウト」または「ファミリー加工」というキーワードが存在する場合。
 * 判定:
   * 上記条件に該当し、かつ部品の工程内にAJ列（工程名）が「ワイヤ放電加工」、「ワイヤーカット」、「ファミリー加工」のいずれかである工程が一つも存在しない場合、エラーとしてカウントされます。
 * ロジック: Y列でファミリー加工が示唆されているのに、主要な関連工程（ワイヤ加工など）がない。
E18: Y列備考｢同時加工(切り離し)｣指示と初期工程の不整合 (CheckE18_PostFamilyCutProcessMismatch_V3)
 * 条件:
   * Y列（部品全体備考）に「同時」というキーワードがあり、かつ「切り離し」、「カット後」、「カットゴ」のいずれかのキーワードも存在する場合（ファミリー加工後の別部品であることを示唆）。
 * 判定:
   * 上記条件に該当し、かつ部品の工程の最初の方（1～3工程目程度）に、AJ列（工程名）が「平面研削 汎用」であり、かつそのAT列（工程備考）またはAS列（加工内容、もしあれば）に「ヘソトリ」、「上面」、「ヘソ取り」といったキーワードを含む工程が存在しない場合、エラーとしてカウントされます。
 * ロジック: Y列で同時加工（切り離し部品）が示唆されているのに、初期工程としてのヘソ取り/基準面出しの「平面研削 汎用」がない。
