1. 部品情報に基づく加工作業工程の自動提案と表示
・ユーザーフォーム（操作画面）起動時に、現在Excelの「工程表」シートで選択されている行の部品情報（材質コード、Z列の文字列、サイズ、品名、備考）を読み込み、操作画面の対応する入力欄に自動で表示します。 
・読み込んだZ列の文字列や備考欄の文字列に特定のキーワード（例：「ミスミ」、「ﾚｲｱｳﾄ」、「同時」）が含まれている場合や、入力されたサイズ情報に基づいて、操作画面上の一部のチェックボックスや選択肢（オプションボタン）を自動的にオンにします。 
・操作画面でユーザーが入力・選択した各種情報（材質、Z列、サイズ、形状オプション、各種加工条件のチェックなど）に基づいて、その部品を加工するために推奨される一連の作業工程を自動的に計算し、リスト（プレビューリスト）に表示します。 
・自動提案される各工程には、事前に「シート2」（マスターデータシート）に登録されている標準的な作業時間（前段取、有人、機械、後段取）や補足情報（備考）が自動でセットされます。 
・特定の条件（例：外注品として扱うか、ミスミから購入する部品か、レイアウト図から切り離して加工するか、特定の外注先（ゲイビ鋼業）に特定の範囲の作業を委託するかなど）に応じて、提案される工程の組み合わせや内容が変化します。 
・Z列に入力された文字列を解析し、その内容に応じてコーティング処理の種類、サブゼロ処理の実施要否、それに伴う外注の必要性や磨き作業の有無を判断し、工程リストに反映させます。 
・平面研削（SG）工程の回数を、部品の形状や選択された加工オプションに基づいて自動的に決定する。 
2. 提案された工程リストの編集機能
・プレビューリストに表示された工程の順番を、↑上に移動ボタンや↓下に移動ボタンを使って自由に入れ替えることができます。 
・リストから特定の工程を選択し、選択複製ボタンを押すことで、その工程をコピーしてすぐ下に追加できます。複製された工程の編集状態（太字表示など）は初期状態に戻ります。 
・リストから不要な工程を選択し、選択削除ボタンで削除できます。 
・プレビューリスト内のいずれかの工程をクリックすると、画面下部に編集専用のエリアが表示され、その工程の「工程名」「業者」「前段取時間」「有人時間」「機械時間」「後段取時間」「備考」を個別に修正できます。 
・編集エリアでの変更後、編集更新ボタンを押すと、修正内容がプレビューリストに反映され、変更された工程は太字で表示されます。 

・ユーザーが後段取時間を手動で編集した場合、その値は記録され、システムによる自動調整よりも優先されます。 
・各作業時間の入力欄には、数字（小数点を含む）のみが入力できるよう制限されており、全角で入力された数字は半角に自動変換され、数字以外の文字が誤って入力された場合は除去されます。 

3. 完成した工程リストのExcelシートへの出力
・工程作成実行ボタンを押すと、プレビューリストに表示されている全ての工程情報を、Excelの「工程表」シートの指定された行以降に書き出します。 
 
・書き出される主な情報は、「工程名」「業者」「前段取時間」「有人時間」「機械時間」「後段取時間」「備考」です。 
・備考欄に「 (数字)/(数字)」という形式の連番（例：MC（小） 1/2）が含まれている場合、シートへの書き出し時にこの連番部分を備考の先頭に移動させて出力します（例：「1/2 MC（小）」）。 
・「工程表」シートへの書き出しと同時に、出力した全工程情報を「LastOutputLog」という名前の別シートにも記録します。このシートが存在しない場合は自動的に作成されます。このログには、ユーザーが手動で編集した後段取時間や、その編集状態を示すフラグも保存されます。 

4. 前回出力した工程の再利用
・前回ログ再出力ボタンを押すことにより、「LastOutputLog」シートに記録されている前回出力した工程情報を全て読み込み、「工程表」シートの現在アクティブになっているセルを開始位置として、再度書き出すことができます。 
5. 特定の単一工程の追加
・操作画面の「単品工程挿入」エリアにあるドロップダウンリストから事前に登録された特定の工程名を選択し、単品挿入ボタンを押すことで、その工程をプレビューリストの最後尾に簡単に追加できます。 
この方法で追加される工程の作業時間や備考は、「シート2」のマスターデータから自動的に取得されます。 
6. 操作に応じた自動調整と連動機能
・操作画面上のチェックボックスの状態を変更したり、ドロップダウンリストの選択肢を変えたり、テキスト入力欄の値を変更したりすると、多くの場合、プレビューリストの内容がこれらの変更を反映して自動的に再計算され、表示が更新されます。 

・特定のチェックボックス（例：「ミスミで購入」を示すチェックボックス）の状態に応じて、関連する他の入力項目（例：「追加工の有無」チェックボックスや「追加工の内容」ドロップダウンリスト）が使用可能になったり（表示/有効）、使用不可になったり（非表示/無効）します。 

・プレビューリスト内の工程が手動で編集されている状態で、リストの内容に影響を与えるような基本情報（材質や形状オプションなど）を変更しようとすると、編集した内容がリセットされる可能性がある旨の確認メッセージが表示され、操作を続行するかキャンセルするかを選択できます。 

・プレビューリストが更新される際、同じ工程名が連続している場合には、備考欄に自動的に連番（例：1/3、2/3、3/3 のような形式）が付与されます。ただし、「外注」という工程名の場合、「ﾜｲﾔ放電加工」という工程名の場合、または備考が「つば荒」や「つば仕上げ」で始まっている場合には、この自動連番処理の対象外となるか、特別なルールで処理されます。 
・連続する同じ工程グループ内では、「後段取時間」は原則としてグループの最後の工程にのみマスターデータから取得した値を設定し、それ以外の同名工程では空白にするよう自動調整されます。ただし、ユーザーが個別に後段取時間を手動で編集した場合は、その編集値が優先されます。 
7. 動作の基盤となるマスターデータ（間接的な機能）
本ツールが正しく動作し、適切な工程を提案するためには、Excelの「シート2」に以下のマスターデータが正確に登録されている必要があります。
・工程時間データ: 各工程名とその詳細条件ごとの標準的な前段取時間、有人時間、機械時間、後段取時間、標準備考、詳細備考。 

・材料情報データ: 材質のコードごとに、その仕入先、通常の熱処理を依頼する業者、サブゼロ処理を依頼する業者、熱処理自体が不要であることを示すフラグ。 

・外注先情報データ: 外注処理の管理キーごとに、実際の外注先名、および操作画面の特定のドロップダウンリストに表示するかどうかを指定するフラグ。 

・Z列キーワード定義データ: Z列に入力される可能性のあるキーワードごとに、それが何を意味するのか（例：コーティングの種類、サブゼロ処理の指示）、システム内部でどの処理キーに対応するのか、外注が必要か、磨き処理が必要かといった情報。 


8. 起動時の初期設定処理
・ユーザーフォーム（操作画面）が起動する際、上記の各種マスターデータを「シート2」から読み込みます。また、操作画面上のコントロール（プレビューリストの列項目設定や、各種ドロップダウンリストの選択肢など）の初期設定を行います。 
・操作画面上の各種ドロップダウンリスト（「ComboBox工程選択」、「cboNameEdit」（編集時の工程名リスト）、「cboSupplierEdit」（編集時の業者名リスト）、「ComboBox2」（外注先選択リスト）など）に表示される選択肢は、「シート2」のマスターデータに基づいて動的に生成されます。このとき、マスターデータ内の特定の列にあるフラグ（例：H列やI列の"〇"、Q列やR列の"〇"など）を参照し、どの項目をリストに含めるかを判断しています。
